{% extends "accounts/profile_base.html" %}

{% block dashboard_content %}
<h2 class="form-title">Редакция на профил</h2>

<form method="POST" enctype="multipart/form-data" class="edit-form">
  {% csrf_token %}

  {% if form.errors %}
    <div class="form-errors">
      {% for field in form %}
        {% for error in field.errors %}
          <p>{{ field.label }}: {{ error }}</p>
        {% endfor %}
      {% endfor %}
    </div>
  {% endif %}

  <div class="form-group">
    <label for="id_username">Потребителско име</label>
    <input type="text" name="username" id="id_username" value="{{ user.username }}" required>
  </div>

  <div class="form-group">
    <label for="id_email">Имейл</label>
    <input type="email" name="email" id="id_email" value="{{ user.email }}" required>
  </div>

  <div class="form-group">
    <label>Снимка (по избор)</label><br>
  
    <!-- Скрити input -->
    <input type="file" name="avatar" id="id_avatar" style="display: none;" onchange="showFileName(this)">
  
    <!-- Видим бутон с икона -->
    <label for="id_avatar" class="file-btn">
      <i class="fa-solid fa-folder-open"></i> Избери файл
    </label>
  
    <!-- Показване на избрано име -->
    <p id="file-name" class="file-name-text">Няма избран файл</p>
  </div>

  <div class="form-group">
    <label for="id_bio">Биография</label>
    <textarea name="bio" id="id_bio" rows="4">{{ user.profile.bio }}</textarea>
  </div>

  <button type="submit" class="btn-save">Запази промените</button>
  <div style="margin-top: 20px; text-align: left;">
    <a href="{% url 'change_password' %}" class="link-change-password">Смени паролата</a>
  </div>
  
</form>
<script>
  function showFileName(input) {
    const fileName = input.files.length > 0 ? input.files[0].name : "Няма избран файл";
    document.getElementById('file-name').textContent = fileName;
  }
</script>
{% endblock %}
